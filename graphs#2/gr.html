<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>PDF</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.css">
	<script type="text/javascript" src="pdfmake.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.min.js"></script>
	<script type="text/javascript" src="vfs_fonts.js"></script>
	<script type="text/javascript">
		drawGraph = function(render) {
			var n = render.length;
			Nodes = new vis.DataSet();
			for(var i=0; i<n; i++) {
				Nodes.add({id: i, label: `Node ${i}`})
			}

			Nodes._data[0].label = "Start";
			Nodes._data[n-1].label = "End";

			Edges = new vis.DataSet();
			for(var i=0; i<n; i++) {
				for(var j=0; j<n; j++) {
					if(render[i][j] != "M" && render[i][j] != "0")
						Edges.add({from: i, to: j, label: render[i][j], arrows: 'to'})
				}
			}

			var container = document.getElementById('test');
			var data = {
				nodes: Nodes,
				edges: Edges
			};
			var options = {};
			var network = new vis.Network(container, data, options);
		}

		renderCommon = function(n, neg=false) {
			var render = [];
			for(var i=0; i<n; i++) {
				render.push("M".repeat(n).split(''));
				for(var j=0; j<n; j++) {
					if(i != j) {
						var range = (neg == false) ? Math.random()*10 : Math.random()*20-10;
						render[i][j] = Math.round(range).toString();
					}
				}
			}

			return render;
		}

		renderMirror = function(n, neg=false) {
			var render = [];
			for(var i=0; i<n; i++) {
				render.push("M".repeat(n).split(''));
			}

			for(var i=0; i<n; i++) {
				for(var j=i; j<n; j++) {
					if(i != j) {
						var range = (neg == false) ? Math.random()*10 : Math.random()*20-10;
						var num = Math.round(range).toString();
						render[i][j] = num;
						render[j][i] = num;
					}
				}
			}

			return render;
		}

		renderMaxPath = function(n) {
			var render = [];
			for(var i=0; i<n; i++) {
				render.push("M".repeat(n).split(''));
				var rnd = Math.round(Math.random()*2+2);
				var count = 0;
				for(var j=i+1; (j<n) && (count<rnd); j++) {
					if(i != j) {
						if((i==0)?true:render[i-1][j] == "M") {
							render[i][j] = Math.round(Math.random()*10).toString();
							count++;
						}
					}
				}
			}

			render[render.length-2][render.length-1] = Math.round(Math.random()*2+render.length-2).toString();

			return render;
		}

		renderPlusMinus = function(n) {
			function check(render) {
				for(var row in render) {
					var count = 0;
					for(var cell in render[row]) {
						if(render[row][cell] == "+") count++;
					}
					if(count == 0) render[row][Math.round(Math.random()*render[row].length-1)] = "+";
				}

				for(var i=0; i<render.length; i++) {
					var count = 0;
					for(var j=0; j<render[i].length; j++) {
						if(render[j][i] == "+") count++;
					}
					if(count == 0) render[j][Math.round(Math.random()*render[j].length-1)] = "+";
				}
			}

			var render = [];
			for(var i=0; i<n; i++) {
				render.push("-".repeat(n).split(''));
				for(var j=0; j<n; j++) {
					if(i != j) {
						render[i][j] = Math.random()<0.5?"+":"-";
					}
				}
			}

			check(render);

			return render;
		}

		N = 10
		function work(draw=true) {

			if(N<3) {
				return;
			}

			var q1 = renderMirror(N);
			var q2 = renderMaxPath(N);
			var q3 = renderCommon(N, true);
			var q4 = renderCommon(N);
			var q5 = renderPlusMinus(N);

			drawGraph(q2);
			setTimeout(function() {
				var docDefinition = {
					content: [
					{ table: { body: q1 } },
					{ text: 'Задача#1' },
					{ table: { body: q2 } },
					{ image: document.querySelector("canvas").toDataURL(), fit: [300, 300] },
					{ text: 'Задача#2' },
					{ table: { body: q3 }, pageBreak: "before" },
					{ text: 'Задача#3' },
					{ table: { body: q4 } },
					{ text: 'Задача#4' },
					{ table: { body: q5 } },
					{ text: 'Задача#5' },
					]
				};

				if(draw)
					pdfMake.createPdf(docDefinition).open();
			}, 1000);

		}

		document.addEventListener('DOMContentLoaded', work, false);
	</script>
</head>
<body>
	<div id="test" style="width: 500px; height: 500px;"></div>
</body>
</html>
